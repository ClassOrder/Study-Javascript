<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        #panel {
            width: 800px;
            height: 600px;
            border: 1px solid grey;
            position: absolute
        }

        #miniNemo {
            position: absolute;
            width: 50px;
            height: 50px;
            top: 0;
            left: 0;
            background-color: yellow
        }
        #shuttle {
            position: absolute;
            width: 30px;
            height: 30px;
            left: 385px;
            top: 570px;
            background-color: blue
        }
    </style>
</head>
<body>
    <div id="panel">
        <div id="miniNemo"></div>
        <div id="shuttle"></div>
    </div>
    <div style="position:absolute;top:620px;">
        <button onclick="onUpdate('start')">시작</button>
        <button onclick="onUpdate('stop')">정지</button>
        <button onclick="onUpdate('clear')">초기화</button>
        <button onclick="speedUp()">증속</button>
        <button onclick="speedDown()">감속</button>
    </div>
    <script>
        'use strict';

        let tryUnit = [];
        let board = {
            xLength: 800,
            yLength: 600
        };

        void function(){
            tryUnit.unit = document.getElementById('shuttle');
            tryUnit.size = 30;
            board.xLength -= tryUnit.size;
            board.yLength -= tryUnit.size;
            tryUnit.positionX = 385;
            tryUnit.positionY = 570;
            tryUnit.unit.style.left = "385px";
            tryUnit.unit.style.top = "570px";
            let unitSpeed = 20;

            document.addEventListener("keydown", function(event){
                switch(event.code){
                    case "ArrowLeft":
                        tryUnit.positionX -= unitSpeed;
                        if(tryUnit.positionX < 0) tryUnit.positionX = 0;
                        tryUnit.unit.style.left = tryUnit.positionX + "px";
                        break;
                    case "ArrowRight":
                        tryUnit.positionX += unitSpeed;
                        if(tryUnit.positionX > board.xLength) tryUnit.positionX = board.xLength;
                        tryUnit.unit.style.left = tryUnit.positionX + "px";
                        break;
                    case "ArrowDown":
                        tryUnit.positionY += unitSpeed;
                        if(tryUnit.positionY > board.yLength) tryUnit.positionY = board.yLength;
                        tryUnit.unit.style.top = tryUnit.positionY + "px";
                        break;
                    case "ArrowUp":
                        tryUnit.positionY -= unitSpeed;
                        if(tryUnit.positionY < 0) tryUnit.positionY = 0;
                        tryUnit.unit.style.top = tryUnit.positionY + "px";
                        break;
                }
            })
        }();

        let miniNemo = document.getElementById('miniNemo').style;
        
        let miniX = 0;
        let miniY = 0;

        let xSpeed = 1;
        let ySpeed = 1;

        let status = "stop";
        let moveInterval;

        function speedUp(){
            if(xSpeed > 0) xSpeed++;
            else if(xSpeed < 0) xSpeed--;
            if(ySpeed > 0) ySpeed++;
            else if(ySpeed < 0) ySpeed--;
        }

        function speedDown(){
            if(Math.abs(xSpeed) == 1) return;
            if(xSpeed > 0) xSpeed--;
            else if(xSpeed < 0) xSpeed++;
            if(ySpeed > 0) ySpeed--;
            else if(ySpeed < 0)ySpeed++;
        }

        function miniMoving() {
            miniX += xSpeed;
            miniY += ySpeed;
            miniNemo.left = miniX + "px";
            miniNemo.top = miniY + "px";
            if (miniX >= 750 || miniX <= 0) xSpeed = xSpeed*-1;
            if (miniY >= 550 || miniY <= 0) ySpeed = ySpeed*-1;
        }

        function onUpdate(order){
            switch(order){
                case "start":
                    if (status !== "start") {
                        moveInterval = setInterval(miniMoving, 10);
                        status = "start";
                    }
                    break;
                case "stop":
                    clearInterval(moveInterval);
                    status = "stop";    
                    break;
                case "clear":
                    if (status === "start") clearInterval(moveInterval);
                    miniNemo.top = 0;
                    miniNemo.left = 0;
                    miniX = 0;
                    miniY = 0;
                    xSpeed = 1;
                    ySpeed = 1;
                    status = "stop";
                    break;
            }
        }
    </script>
</body>
</html>